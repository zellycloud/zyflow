# Tab 1: User & Language Settings
# Priority: REQUIRED (must complete first)
# Questions: 3

metadata:
  id: tab_1_user_language
  label: "Tab 1: User & Language"
  description: "Configure user name, conversation language, agent prompt language"
  priority: REQUIRED
  order: 1
  setting_count: 3

# Target files for CLAUDE.md reference
target_sections:
  - sections/user.yaml
  - sections/language.yaml

batches:
  - batch_id: "1.1"
    label: "Basic Settings"
    conditional: false
    questions:
      # Q1: User Name
      # UX Note: For text_input, only show "Keep Current" option.
      # Users should type directly in "Type something" field to enter new value.
      - id: user_name
        question: "What is your name? To change, type your name in the text field below."
        header: "User Name"
        field: "user.name"
        type: text_input
        multi_select: false
        required: true
        options:
          - label: "Keep Current Value"
            description: "Continue using current name (to change, type in the field below)"
            value: "{{current}}"
        target:
          file: "sections/user.yaml"
          path: "user.name"
        env_sync: "MOAI_USER_NAME"

      # Q2: Conversation Language
      - id: conversation_language
        question: "What language should Alfred use in conversations?"
        header: "Language"
        field: "language.conversation_language"
        type: select_single
        multi_select: false
        required: true
        options:
          - label: "Korean (ko)"
            description: "All content will be generated in Korean"
            value: "ko"
          - label: "English (en)"
            description: "All content will be generated in English"
            value: "en"
          - label: "Japanese (ja)"
            description: "All content will be generated in Japanese"
            value: "ja"
          - label: "Spanish (es)"
            description: "All content will be generated in Spanish"
            value: "es"
        target:
          file: "sections/language.yaml"
          path: "language.conversation_language"
        env_sync: "MOAI_CONVERSATION_LANG"
        auto_update:
          - field: "language.conversation_language_name"
            mapping:
              ko: "Korean"
              en: "English"
              ja: "Japanese"
              es: "Spanish"

      # Q3: Agent Prompt Language
      - id: agent_prompt_language
        question: "What language should agent prompts use?"
        header: "Agent Language"
        field: "language.agent_prompt_language"
        type: select_single
        multi_select: false
        required: true
        options:
          - label: "Same as Conversation"
            description: "Use conversation language for agent prompts"
            value: "{{language.conversation_language}}"
          - label: "English"
            description: "Always use English for agent prompts (recommended)"
            value: "en"
        target:
          file: "sections/language.yaml"
          path: "language.agent_prompt_language"
        env_sync: "MOAI_AGENT_PROMPT_LANG"

validation:
  checkpoint: "after_tab_1"
  rules:
    - name: "validate_conversation_language"
      description: "Verify conversation_language is valid"
      field: "language.conversation_language"
      validation: "enum"
      allowed_values: ["ko", "en", "ja", "es", "zh", "fr", "de"]
    - name: "validate_agent_prompt_language"
      description: "Verify agent_prompt_language consistency"
      field: "language.agent_prompt_language"
      validation: "enum"
      allowed_values: ["ko", "en", "ja", "es", "zh", "fr", "de"]

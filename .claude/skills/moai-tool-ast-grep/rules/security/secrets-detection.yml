# Secrets and Credentials Detection Rules

id: hardcoded-password-python
language: python
severity: error
message: "Hardcoded credential detected. Use environment variables."
rule:
  any:
    - pattern: password = "$$$VALUE"
    - pattern: PASSWORD = "$$$VALUE"
    - pattern: passwd = "$$$VALUE"
    - pattern: secret = "$$$VALUE"
    - pattern: SECRET = "$$$VALUE"
    - pattern: api_key = "$$$VALUE"
    - pattern: API_KEY = "$$$VALUE"
    - pattern: apikey = "$$$VALUE"

---
id: hardcoded-password-js
language: javascript
severity: error
message: "Hardcoded credential detected. Use environment variables."
rule:
  any:
    - pattern: "password: '$$$VALUE'"
    - pattern: 'password: "$$$VALUE"'
    - pattern: "apiKey: '$$$VALUE'"
    - pattern: 'apiKey: "$$$VALUE"'
    - pattern: "secret: '$$$VALUE'"
    - pattern: 'secret: "$$$VALUE"'
    - pattern: const password = "$$$VALUE"
    - pattern: const apiKey = "$$$VALUE"

---
id: hardcoded-password-ts
language: typescript
severity: error
message: "Hardcoded credential detected. Use environment variables."
rule:
  any:
    - pattern: "password: '$$$VALUE'"
    - pattern: 'password: "$$$VALUE"'
    - pattern: "apiKey: '$$$VALUE'"
    - pattern: 'apiKey: "$$$VALUE"'
    - pattern: const password = "$$$VALUE"
    - pattern: const apiKey = "$$$VALUE"

---
id: hardcoded-jwt-secret
language: javascript
severity: error
message: "JWT secret should not be hardcoded"
rule:
  any:
    - pattern: jwt.sign($PAYLOAD, "$SECRET")
    - pattern: jwt.verify($TOKEN, "$SECRET")

---
id: hardcoded-jwt-secret-ts
language: typescript
severity: error
message: "JWT secret should not be hardcoded"
rule:
  any:
    - pattern: jwt.sign($PAYLOAD, "$SECRET")
    - pattern: jwt.verify($TOKEN, "$SECRET")

---
id: aws-credentials-python
language: python
severity: error
message: "AWS credentials should not be hardcoded"
rule:
  any:
    - pattern: aws_access_key_id = "$$$VALUE"
    - pattern: aws_secret_access_key = "$$$VALUE"
    - pattern: AWS_ACCESS_KEY_ID = "$$$VALUE"
    - pattern: AWS_SECRET_ACCESS_KEY = "$$$VALUE"

---
id: private-key-detection
language: python
severity: error
message: "Private key should not be hardcoded in source code"
rule:
  any:
    - pattern: private_key = "$$$VALUE"
    - pattern: PRIVATE_KEY = "$$$VALUE"
    - pattern: ssh_key = "$$$VALUE"
